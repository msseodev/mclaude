# Autonomous Mode v2 â€” PRD

## 1. ê°œìš”

### 1.1 ë°°ê²½

í˜„ì¬ ììœ¨ ëª¨ë“œ(v1)ëŠ” ë‹¨ì¼ ì—ì´ì „íŠ¸ê°€ discovery â†’ fix â†’ test â†’ improve â†’ review ì‚¬ì´í´ì„ ë°˜ë³µí•˜ëŠ” êµ¬ì¡°ë‹¤.
ì´ ë°©ì‹ì€ ê¸°ì¡´ í”„ë¡œì íŠ¸ì˜ ë²„ê·¸ ìˆ˜ì •ì´ë‚˜ ê°œì„ ì—ëŠ” ì í•©í•˜ì§€ë§Œ, ë‹¤ìŒê³¼ ê°™ì€ í•œê³„ê°€ ìˆë‹¤:

1. **í”„ë¡œì íŠ¸ ìƒì„± ë¶ˆê°€** â€” ë¹ˆ ë””ë ‰í† ë¦¬ì—ì„œ ì‹œì‘í•  ë•Œ "ë¬´ì—‡ì„ ë§Œë“¤ì§€" ì•Œ ìˆ˜ ì—†ìŒ
2. **ì‚¬ìš©ì ë°©í–¥ ì œì‹œ ë¶ˆê°€** â€” ì‹¤í–‰ ì¤‘ ì‚¬ìš©ìê°€ ë°©í–¥ì„ ìˆ˜ì •í•˜ê±°ë‚˜ ìƒˆë¡œìš´ ì§€ì‹œë¥¼ ë‚´ë¦´ ìˆ˜ ì—†ìŒ
3. **ë‹¨ì¼ ì—­í• ì˜ í•œê³„** â€” í•˜ë‚˜ì˜ í”„ë¡¬í”„íŠ¸ê°€ ê¸°íš/ê°œë°œ/ë¦¬ë·°/QAë¥¼ ëª¨ë‘ ë‹´ë‹¹í•˜ë©´ ê° ì—­í• ì˜ ê¹Šì´ê°€ ì–•ì•„ì§

### 1.2 ëª©í‘œ

- **User Prompt ì‹œìŠ¤í…œ**: ì‚¬ìš©ìê°€ ì´ˆê¸° ì˜ë„ë¥¼ ì „ë‹¬í•˜ê³ , ì‹¤í–‰ ì¤‘ì—ë„ ë°©í–¥ì„ ì¡°ì •í•  ìˆ˜ ìˆê²Œ í•œë‹¤
- **Agent Pipeline**: ì—­í• ë³„ ì „ë¬¸ ì—ì´ì „íŠ¸ê°€ ìˆœì°¨ì ìœ¼ë¡œ í˜‘ì—…í•˜ëŠ” íŒŒì´í”„ë¼ì¸ì„ êµ¬ì„±í•œë‹¤
- **Agent ì •ì˜ ì‹œìŠ¤í…œ**: ë§ˆí¬ë‹¤ìš´ í˜•ì‹ìœ¼ë¡œ ì—ì´ì „íŠ¸ë¥¼ ì •ì˜í•˜ê³  ì»¤ìŠ¤í„°ë§ˆì´ì§•í•  ìˆ˜ ìˆê²Œ í•œë‹¤

### 1.3 í•µì‹¬ ë³€ê²½ ìš”ì•½

| í•­ëª© | v1 (í˜„ì¬) | v2 (ëª©í‘œ) |
|------|-----------|-----------|
| ì‚¬ì´í´ êµ¬ì¡° | Phase ê¸°ë°˜ (discovery/fix/test/...) | Agent Pipeline (Designer â†’ Developer â†’ Reviewer â†’ QA) |
| ì‚¬ìš©ì ì…ë ¥ | ì—†ìŒ (ìë™ íŒë‹¨) | ì´ˆê¸° prompt + ì¤‘ê°„ prompt ì£¼ì… |
| ì—ì´ì „íŠ¸ ìˆ˜ | 1 (ë‹¨ì¼) | 4 (íŒŒì´í”„ë¼ì¸, ì»¤ìŠ¤í„°ë§ˆì´ì§• ê°€ëŠ¥) |
| í”„ë¡œì íŠ¸ ìƒì„± | ë¶ˆê°€ | ê°€ëŠ¥ (ì´ˆê¸° prompt ê¸°ë°˜) |

---

## 2. User Prompt ì‹œìŠ¤í…œ

### 2.1 ê°œë…

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  User Prompt                      â”‚
â”‚                                                   â”‚
â”‚  = Initial Prompt + Mid-Session Prompts (ëˆ„ì )    â”‚
â”‚                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Initial Prompt                               â”‚ â”‚
â”‚  â”‚ "React + TypeScriptë¡œ í• ì¼ ê´€ë¦¬ ì•±ì„ ë§Œë“¤ì–´ì¤˜. â”‚ â”‚
â”‚  â”‚  Tailwind CSS ì‚¬ìš©, ëª¨ë°”ì¼ ìš°ì„  ë°˜ì‘í˜• UI,    â”‚ â”‚
â”‚  â”‚  ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ë¡œ ë°ì´í„° ì˜ì†í™”"               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                     +                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Mid-Session Prompt #1 (Cycle 5ì—ì„œ ì¶”ê°€)     â”‚ â”‚
â”‚  â”‚ "ë‹¤í¬ëª¨ë“œ ì§€ì›ì„ ì¶”ê°€í•´ì¤˜"                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                     +                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Mid-Session Prompt #2 (Cycle 12ì—ì„œ ì¶”ê°€)    â”‚ â”‚
â”‚  â”‚ "ë“œë˜ê·¸ì•¤ë“œë¡­ìœ¼ë¡œ í• ì¼ ìˆœì„œ ë³€ê²½ ê°€ëŠ¥í•˜ê²Œ"    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 Initial Prompt (ì´ˆê¸° í”„ë¡¬í”„íŠ¸)

**ììœ¨ ëª¨ë“œ ì‹œì‘ ì‹œ ì‚¬ìš©ìê°€ ì…ë ¥í•˜ëŠ” í”„ë¡œì íŠ¸ ì˜ë„.**

- ììœ¨ ëª¨ë“œ ì‹œì‘ ë²„íŠ¼ í´ë¦­ ì‹œ ëª¨ë‹¬/ì…ë ¥ ì˜ì—­ì´ í‘œì‹œë¨
- ë¹ˆ ë””ë ‰í† ë¦¬ â†’ **í•„ìˆ˜** (ë¬´ì—‡ì„ ë§Œë“¤ì§€ ëª¨ë¥´ë©´ ì‹œì‘ ë¶ˆê°€)
- ê¸°ì¡´ í”„ë¡œì íŠ¸ â†’ **ì„ íƒ** (ì—†ìœ¼ë©´ v1ì²˜ëŸ¼ ìë™ ë¶„ì„ë¶€í„° ì‹œì‘)
- DBì— `auto_sessions.initial_prompt` ì»¬ëŸ¼ìœ¼ë¡œ ì €ì¥
- ëª¨ë“  ì—ì´ì „íŠ¸ì˜ í”„ë¡¬í”„íŠ¸ì— ì»¨í…ìŠ¤íŠ¸ë¡œ ì£¼ì…ë¨

**ì…ë ¥ ì˜ˆì‹œ:**

```
Reactì™€ Next.jsë¡œ ê°œì¸ ë¸”ë¡œê·¸ í”Œë«í¼ì„ ë§Œë“¤ì–´ì¤˜.
- ë§ˆí¬ë‹¤ìš´ìœ¼ë¡œ ê¸€ ì‘ì„±
- íƒœê·¸ ê¸°ë°˜ ë¶„ë¥˜
- ë‹¤í¬/ë¼ì´íŠ¸ í…Œë§ˆ
- SEO ìµœì í™”
- ë°˜ì‘í˜• ëª¨ë°”ì¼ ì§€ì›
```

### 2.3 Mid-Session Prompt (ì¤‘ê°„ í”„ë¡¬í”„íŠ¸)

**ì„¸ì…˜ ì‹¤í–‰ ì¤‘(ë˜ëŠ” ì¼ì‹œì •ì§€ í›„ ì¬ê°œ ì‹œ) ì‚¬ìš©ìê°€ ì¶”ê°€í•˜ëŠ” ì§€ì‹œ.**

- ì¼ì‹œì •ì§€(Pause) ìƒíƒœì—ì„œ ì¬ê°œ(Resume) ì‹œ í”„ë¡¬í”„íŠ¸ ì…ë ¥ ê°€ëŠ¥
- ì‹¤í–‰ ì¤‘ì—ë„ "Add Prompt" ë²„íŠ¼ìœ¼ë¡œ ì¦‰ì‹œ ì¶”ê°€ ê°€ëŠ¥ (ë‹¤ìŒ ì‚¬ì´í´ë¶€í„° ë°˜ì˜)
- `auto_user_prompts` í…Œì´ë¸”ì— ëˆ„ì  ì €ì¥
- User Prompt = Initial Prompt + ëª¨ë“  Mid-Session Prompts (ì‹œê°„ìˆœ í•©ì‚°)
- ê° ì—ì´ì „íŠ¸ëŠ” ë§¤ ì‚¬ì´í´ ì‹œì‘ ì‹œ ìµœì‹  User Promptë¥¼ ë°›ìŒ

### 2.4 User Prompt êµ¬ì„± ê·œì¹™

```typescript
function buildUserPrompt(session: AutoSession, prompts: AutoUserPrompt[]): string {
  const parts: string[] = [];

  // 1. Initial Prompt (í•­ìƒ ìµœìƒë‹¨)
  if (session.initial_prompt) {
    parts.push(`## í”„ë¡œì íŠ¸ ëª©í‘œ\n${session.initial_prompt}`);
  }

  // 2. Mid-Session Prompts (ì‹œê°„ìˆœ)
  if (prompts.length > 0) {
    parts.push(`## ì¶”ê°€ ì§€ì‹œì‚¬í•­`);
    for (const p of prompts) {
      parts.push(`- [Cycle ${p.added_at_cycle}] ${p.content}`);
    }
  }

  return parts.join('\n\n');
}
```

---

## 3. Agent Pipeline

### 3.1 êµ¬ì¡°

í•˜ë‚˜ì˜ ì‚¬ì´í´ì—ì„œ ì—ì´ì „íŠ¸ê°€ **ìˆœì°¨ì  íŒŒì´í”„ë¼ì¸**ìœ¼ë¡œ ì‹¤í–‰ëœë‹¤.
ê° ì—ì´ì „íŠ¸ì˜ ì¶œë ¥ì´ ë‹¤ìŒ ì—ì´ì „íŠ¸ì˜ ì…ë ¥(ì»¨í…ìŠ¤íŠ¸)ì´ ëœë‹¤.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Cycle #N                                â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   Product    â”‚â”€â”€â–¶â”‚ Developer â”‚â”€â”€â–¶â”‚ Reviewer â”‚â”€â”€â–¶â”‚  QA  â”‚ â”‚
â”‚  â”‚  Designer    â”‚   â”‚           â”‚   â”‚          â”‚   â”‚      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚        â”‚                 â”‚               â”‚             â”‚     â”‚
â”‚        â–¼                 â–¼               â–¼             â–¼     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Feature   â”‚   â”‚   Code    â”‚   â”‚  Review   â”‚ â”‚  Test   â”‚ â”‚
â”‚  â”‚   Spec     â”‚   â”‚  Changes  â”‚   â”‚ Feedback  â”‚ â”‚ Results â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                        â”‚                     â”‚
â”‚                                        â–¼                     â”‚
â”‚                                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚                                  â”‚ Developer  â”‚ (í”¼ë“œë°± ë°˜ì˜) â”‚
â”‚                                  â”‚  (2nd run) â”‚              â”‚
â”‚                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 íŒŒì´í”„ë¼ì¸ ì‹¤í–‰ íë¦„

```
1. [Product Designer] User Prompt + SESSION-STATE.mdë¥¼ ë¶„ì„
   â†’ ì´ë²ˆ ì‚¬ì´í´ì—ì„œ ì‘ì—…í•  ê¸°ëŠ¥/íƒœìŠ¤í¬ ìŠ¤í™ ì¶œë ¥
   â†’ output: Feature Spec (JSON)

2. [Developer] Feature Spec + User Prompt + SESSION-STATE.mdë¥¼ ë°›ì•„
   â†’ ì½”ë“œ êµ¬í˜„
   â†’ output: ì½”ë“œ ë³€ê²½ì‚¬í•­

3. [Reviewer] Developerì˜ ì½”ë“œ ë³€ê²½ì‚¬í•­ì„ ë¦¬ë·°
   â†’ ì½”ë“œ í’ˆì§ˆ, ë²„ê·¸ ê°€ëŠ¥ì„±, ì„¤ê³„ í”¼ë“œë°±
   â†’ output: Review Feedback (JSON)
   â†’ ì´ìŠˆ ë°œê²¬ ì‹œ â†’ Developer ì¬ì‹¤í–‰ (ìµœëŒ€ NíšŒ)

4. [QA Engineer] í…ŒìŠ¤íŠ¸ ì‹¤í–‰ + ê²°ê³¼ ë¶„ì„
   â†’ í…ŒìŠ¤íŠ¸ í†µê³¼ ì—¬ë¶€, ìƒˆë¡œìš´ ë²„ê·¸ ë°œê²¬
   â†’ output: Test Report
   â†’ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ ì‹œ â†’ Developer ì¬ì‹¤í–‰ ë˜ëŠ” rollback
```

### 3.3 Reviewer â†” Developer ë°˜ë³µ ë£¨í”„

Reviewerê°€ ì´ìŠˆë¥¼ ë°œê²¬í•˜ë©´ Developerì—ê²Œ í”¼ë“œë°±ì„ ì „ë‹¬í•˜ê³  ì¬ì‹¤í–‰í•œë‹¤.
ë¬´í•œ ë£¨í”„ ë°©ì§€ë¥¼ ìœ„í•´ **ìµœëŒ€ ë°˜ë³µ íšŸìˆ˜(review_max_iterations)** ì„¤ì •ì´ ìˆë‹¤.

```
Developer â†’ Reviewer â†’ [ì´ìŠˆ ìˆìŒ?]
                           â”‚
                  YES â”€â”€â”€â”€ â”‚ â”€â”€â”€â”€ NO
                  â”‚                â”‚
                  â–¼                â–¼
            Developer         QA Engineer
           (í”¼ë“œë°± ë°˜ì˜)      (í…ŒìŠ¤íŠ¸ ì‹¤í–‰)
                  â”‚
                  â–¼
              Reviewer
            (ì¬ë¦¬ë·°, ìµœëŒ€ NíšŒ)
```

ê¸°ë³¸ê°’: `review_max_iterations = 2` (Developer ìµœëŒ€ 2íšŒ ì¶”ê°€ ìˆ˜ì •)

### 3.4 QA ì‹¤íŒ¨ ì‹œ ì²˜ë¦¬

```
QA Engineer â†’ [í…ŒìŠ¤íŠ¸ í†µê³¼?]
                   â”‚
          YES â”€â”€â”€â”€ â”‚ â”€â”€â”€â”€ NO
          â”‚                â”‚
          â–¼                â–¼
     ì‚¬ì´í´ ì™„ë£Œ      [rollback ì„¤ì •?]
     (ë‹¤ìŒ ì‚¬ì´í´)          â”‚
                    YES â”€â”€ â”‚ â”€â”€ NO
                    â”‚            â”‚
                    â–¼            â–¼
              Git Rollback   Finding ìƒì„±
              + Finding ìƒì„±  (ë‹¤ìŒ ì‚¬ì´í´ì—ì„œ fix)
```

---

## 4. Agent ì •ì˜ ì‹œìŠ¤í…œ

### 4.1 ê°œë…

ì—ì´ì „íŠ¸ëŠ” `.md` íŒŒì¼ í˜•ì‹ìœ¼ë¡œ ì •ì˜ëœë‹¤. Claude Codeì˜ `.claude/agents/*.md`ì™€ ë™ì¼í•œ ê°œë…ì´ë‹¤.
mclaudeëŠ” ì´ ì •ì˜ë¥¼ DBì— ì €ì¥í•˜ê³ , UIì—ì„œ í¸ì§‘í•  ìˆ˜ ìˆê²Œ í•œë‹¤.

### 4.2 Agent ì •ì˜ í˜•ì‹

ê° ì—ì´ì „íŠ¸ëŠ” ë‹¤ìŒ êµ¬ì¡°ì˜ ë§ˆí¬ë‹¤ìš´ ë¬¸ì„œë¡œ ì •ì˜ëœë‹¤:

```markdown
# Product Designer

## Role
ì„œë¹„ìŠ¤ì˜ ê¸°ëŠ¥ ìŠ¤í™ê³¼ UXë¥¼ ì„¤ê³„í•˜ëŠ” í”„ë¡œë•íŠ¸ ë””ìì´ë„ˆì…ë‹ˆë‹¤.
ì—”ì§€ë‹ˆì–´ê°€ ì•„ë‹Œ ê¸°íšìì˜ ê´€ì ì—ì„œ, ì‚¬ìš©ì ê²½í—˜ì„ ì¤‘ì‹¬ìœ¼ë¡œ ê¸°ëŠ¥ì„ ì •ì˜í•©ë‹ˆë‹¤.

## System Prompt
ë‹¹ì‹ ì€ í”„ë¡œë•íŠ¸ ë””ìì´ë„ˆì…ë‹ˆë‹¤.

ì‚¬ìš©ìì˜ ìš”êµ¬ì‚¬í•­(User Prompt)ê³¼ í˜„ì¬ í”„ë¡œì íŠ¸ ìƒíƒœ(Session State)ë¥¼ ë¶„ì„í•˜ì—¬,
ì´ë²ˆ ì‚¬ì´í´ì—ì„œ ê°œë°œí•´ì•¼ í•  ê¸°ëŠ¥ì˜ ìŠ¤í™ì„ ì‘ì„±í•˜ì„¸ìš”.

### ì—­í• 
- ì‚¬ìš©ìì˜ ì˜ë„ë¥¼ êµ¬ì²´ì ì¸ ê¸°ëŠ¥ ìš”êµ¬ì‚¬í•­ìœ¼ë¡œ ë³€í™˜
- UI/UX íë¦„ ì„¤ê³„
- ìš°ì„ ìˆœìœ„ ê²°ì • (ì–´ë–¤ ê¸°ëŠ¥ì„ ë¨¼ì € ë§Œë“¤ì§€)
- ìˆ˜ìš© ê¸°ì¤€(Acceptance Criteria) ì •ì˜

### ì œì•½
- ê¸°ìˆ ì  êµ¬í˜„ ë°©ë²•ì„ ì§€ì‹œí•˜ì§€ ë§ˆì„¸ìš” (Developerì˜ ì˜ì—­)
- ì´ë¯¸ êµ¬í˜„ëœ ê¸°ëŠ¥ì€ ë‹¤ì‹œ ì •ì˜í•˜ì§€ ë§ˆì„¸ìš”
- í•œ ì‚¬ì´í´ì— ë„ˆë¬´ ë§ì€ ê¸°ëŠ¥ì„ ë„£ì§€ ë§ˆì„¸ìš” (1~3ê°œê°€ ì ë‹¹)

### ì¶œë ¥ í˜•ì‹
ë°˜ë“œì‹œ ì•„ë˜ JSON í˜•ì‹ìœ¼ë¡œ ì¶œë ¥í•˜ì„¸ìš”:
{
  "features": [
    {
      "title": "ê¸°ëŠ¥ ì œëª©",
      "description": "ìƒì„¸ ì„¤ëª…",
      "acceptance_criteria": ["ê¸°ì¤€1", "ê¸°ì¤€2"],
      "priority": "P0|P1|P2",
      "ui_flow": "ì‚¬ìš©ì íë¦„ ì„¤ëª… (optional)"
    }
  ],
  "notes": "Developerì—ê²Œ ì „ë‹¬í•  ì¶”ê°€ ì°¸ê³ ì‚¬í•­"
}

## Pipeline Order
1

## Enabled
true
```

### 4.3 ê¸°ë³¸ ì—ì´ì „íŠ¸ ì •ì˜

#### 4.3.1 Product Designer (íŒŒì´í”„ë¼ì¸ ìˆœì„œ: 1)

| í•­ëª© | ê°’ |
|------|-----|
| **ì—­í• ** | ì„œë¹„ìŠ¤ ìŠ¤í™/ê¸°ëŠ¥/UX ì •ì˜ |
| **ì…ë ¥** | User Prompt + SESSION-STATE.md |
| **ì¶œë ¥** | Feature Spec (JSON) |
| **ê´€ì ** | ì‚¬ìš©ì ê²½í—˜ ì¤‘ì‹¬, ë¹„ì¦ˆë‹ˆìŠ¤ ìš”êµ¬ì‚¬í•­ |

- ë¹ˆ í”„ë¡œì íŠ¸: ì´ˆê¸° ì•„í‚¤í…ì²˜ì™€ í•µì‹¬ ê¸°ëŠ¥ ì •ì˜
- ê¸°ì¡´ í”„ë¡œì íŠ¸: ë‹¤ìŒ êµ¬í˜„í•  ê¸°ëŠ¥ ë˜ëŠ” ê°œì„ ì  ë„ì¶œ
- ì‚¬ìš©ìì˜ ì¶”ê°€ ì§€ì‹œ(Mid-Session Prompt)ë¥¼ ìš°ì„  ë°˜ì˜

#### 4.3.2 Developer (íŒŒì´í”„ë¼ì¸ ìˆœì„œ: 2)

| í•­ëª© | ê°’ |
|------|-----|
| **ì—­í• ** | ì½”ë“œ êµ¬í˜„ |
| **ì…ë ¥** | Feature Spec (Designer ì¶œë ¥) + User Prompt + SESSION-STATE.md |
| **ì¶œë ¥** | ì½”ë“œ ë³€ê²½ì‚¬í•­ |
| **ê´€ì ** | ê¸°ìˆ ì  êµ¬í˜„, ì½”ë“œ í’ˆì§ˆ |

- Feature Specì˜ ìš”êµ¬ì‚¬í•­ì„ ì½”ë“œë¡œ êµ¬í˜„
- í•„ìš”í•œ ê²½ìš° í…ŒìŠ¤íŠ¸ ì½”ë“œë„ ì‘ì„±
- Reviewer í”¼ë“œë°± ìˆ˜ì‹  ì‹œ: í”¼ë“œë°± ë‚´ìš©ì„ ë°˜ì˜í•˜ì—¬ ì½”ë“œ ìˆ˜ì •
- ìµœì†Œí•œì˜ ë³€ê²½ ì›ì¹™ (ë¶ˆí•„ìš”í•œ ë¦¬íŒ©í† ë§ ê¸ˆì§€)

#### 4.3.3 Reviewer (íŒŒì´í”„ë¼ì¸ ìˆœì„œ: 3)

| í•­ëª© | ê°’ |
|------|-----|
| **ì—­í• ** | ì½”ë“œ ë¦¬ë·° |
| **ì…ë ¥** | Developerì˜ ì½”ë“œ ë³€ê²½ì‚¬í•­ (git diff) + Feature Spec |
| **ì¶œë ¥** | Review Feedback (JSON) |
| **ê´€ì ** | ì½”ë“œ í’ˆì§ˆ, ë²„ê·¸ ê°€ëŠ¥ì„±, ì„¤ê³„ ì¼ê´€ì„± |

- Developerê°€ ì‘ì„±í•œ ì½”ë“œì˜ í’ˆì§ˆ ê²€ì¦
- ë²„ê·¸ ê°€ëŠ¥ì„±, ì—£ì§€ ì¼€ì´ìŠ¤, ì—ëŸ¬ í•¸ë“¤ë§ ì ê²€
- Feature Spec ëŒ€ë¹„ ëˆ„ë½ëœ ìš”êµ¬ì‚¬í•­ í™•ì¸
- ì´ìŠˆ ë°œê²¬ ì‹œ Developerì—ê²Œ êµ¬ì²´ì  í”¼ë“œë°± ì „ë‹¬

**ì¶œë ¥ í˜•ì‹:**
```json
{
  "approved": false,
  "issues": [
    {
      "severity": "critical|major|minor",
      "file": "src/path/to/file.ts",
      "description": "ì´ìŠˆ ì„¤ëª…",
      "suggestion": "ìˆ˜ì • ì œì•ˆ"
    }
  ],
  "summary": "ì „ì²´ ë¦¬ë·° ìš”ì•½"
}
```

- `approved: true` â†’ QA ë‹¨ê³„ë¡œ ì§„í–‰
- `approved: false` + critical/major ì´ìŠˆ â†’ Developer ì¬ì‹¤í–‰

#### 4.3.4 QA Engineer (íŒŒì´í”„ë¼ì¸ ìˆœì„œ: 4)

| í•­ëª© | ê°’ |
|------|-----|
| **ì—­í• ** | í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ë° í’ˆì§ˆ ê²€ì¦ |
| **ì…ë ¥** | ì½”ë“œ ë³€ê²½ì‚¬í•­ + Feature Spec + test_command |
| **ì¶œë ¥** | Test Report (JSON) |
| **ê´€ì ** | ê¸°ëŠ¥ ë™ì‘ ê²€ì¦, íšŒê·€ ë°©ì§€ |

- ì„¤ì •ëœ í…ŒìŠ¤íŠ¸ ëª…ë ¹ì–´ ì‹¤í–‰
- Feature Specì˜ Acceptance Criteria ê¸°ë°˜ ê²€ì¦
- í…ŒìŠ¤íŠ¸ ê²°ê³¼ ë¶„ì„ ë° êµ¬ì¡°í™”ëœ ë¦¬í¬íŠ¸ ìƒì„±
- ì‹¤íŒ¨ ì‹œ Finding ìƒì„± (ë‹¤ìŒ ì‚¬ì´í´ì—ì„œ ìˆ˜ì •)

### 4.4 ì»¤ìŠ¤í…€ ì—ì´ì „íŠ¸

ì‚¬ìš©ìëŠ” ê¸°ë³¸ 4ê°œ ì—ì´ì „íŠ¸ ì™¸ì— ì¶”ê°€ ì—ì´ì „íŠ¸ë¥¼ ì •ì˜í•  ìˆ˜ ìˆë‹¤.

**ì˜ˆì‹œ: Security Auditor (ë³´ì•ˆ ê°ì‚¬ì)**

```markdown
# Security Auditor

## Role
ì½”ë“œì˜ ë³´ì•ˆ ì·¨ì•½ì ì„ ë¶„ì„í•˜ëŠ” ë³´ì•ˆ ì „ë¬¸ê°€ì…ë‹ˆë‹¤.

## System Prompt
ë‹¹ì‹ ì€ ë³´ì•ˆ ì „ë¬¸ê°€ì…ë‹ˆë‹¤. ì½”ë“œì—ì„œ ë‹¤ìŒì„ ì ê²€í•˜ì„¸ìš”:
- XSS, SQL Injection, CSRF ë“± OWASP Top 10
- ì¸ì¦/ì¸ê°€ ë¡œì§
- ë¯¼ê° ë°ì´í„° ë…¸ì¶œ
- ì˜ì¡´ì„± ì·¨ì•½ì 

## Pipeline Order
3.5

## Enabled
true
```

`Pipeline Order`ê°€ 3.5ì´ë©´ Reviewer(3)ì™€ QA(4) ì‚¬ì´ì— ì‹¤í–‰ëœë‹¤.
ì†Œìˆ˜ì  ìˆœì„œë¡œ ê¸°ì¡´ íŒŒì´í”„ë¼ì¸ ì‚¬ì´ì— ì—ì´ì „íŠ¸ë¥¼ ì‚½ì…í•  ìˆ˜ ìˆë‹¤.

### 4.5 ì—ì´ì „íŠ¸ ë¹„í™œì„±í™”

`Enabled: false`ë¡œ ì„¤ì •í•˜ë©´ íŒŒì´í”„ë¼ì¸ì—ì„œ ì œì™¸ëœë‹¤.
ì˜ˆ: Reviewerë¥¼ ë¹„í™œì„±í™”í•˜ë©´ Developer â†’ QAë¡œ ì§í–‰.

---

## 5. ë°ì´í„° ëª¨ë¸

### 5.1 ë³€ê²½ ì‚¬í•­

#### ê¸°ì¡´ í…Œì´ë¸” ìˆ˜ì •

```sql
-- auto_sessions: ì´ˆê¸° í”„ë¡¬í”„íŠ¸ ì¶”ê°€
ALTER TABLE auto_sessions ADD COLUMN initial_prompt TEXT;
```

#### ì‹ ê·œ í…Œì´ë¸”

```sql
-- ì‚¬ìš©ì í”„ë¡¬í”„íŠ¸ ëˆ„ì  (Mid-Session Prompts)
CREATE TABLE auto_user_prompts (
  id TEXT PRIMARY KEY,
  session_id TEXT NOT NULL REFERENCES auto_sessions(id) ON DELETE CASCADE,
  content TEXT NOT NULL,
  added_at_cycle INTEGER NOT NULL DEFAULT 0,  -- ì–´ë–¤ ì‚¬ì´í´ì—ì„œ ì¶”ê°€ë˜ì—ˆëŠ”ì§€
  created_at TEXT NOT NULL
);

-- ì—ì´ì „íŠ¸ ì •ì˜
CREATE TABLE auto_agents (
  id TEXT PRIMARY KEY,
  name TEXT NOT NULL UNIQUE,          -- 'product_designer', 'developer', 'reviewer', 'qa_engineer'
  display_name TEXT NOT NULL,          -- 'Product Designer'
  role_description TEXT NOT NULL,      -- ì—­í•  í•œì¤„ ì„¤ëª…
  system_prompt TEXT NOT NULL,         -- ì „ì²´ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ (ë§ˆí¬ë‹¤ìš´)
  pipeline_order REAL NOT NULL,        -- ì‹¤í–‰ ìˆœì„œ (ì†Œìˆ˜ì  ê°€ëŠ¥: 1, 2, 3, 3.5, 4)
  enabled INTEGER NOT NULL DEFAULT 1,  -- 1=í™œì„±, 0=ë¹„í™œì„±
  is_builtin INTEGER NOT NULL DEFAULT 0, -- 1=ê¸°ë³¸ ì—ì´ì „íŠ¸ (ì‚­ì œ ë¶ˆê°€)
  created_at TEXT NOT NULL,
  updated_at TEXT NOT NULL
);

-- ì—ì´ì „íŠ¸ ì‹¤í–‰ ê¸°ë¡ (ì‚¬ì´í´ ë‚´ ê° ì—ì´ì „íŠ¸ì˜ ì‹¤í–‰ ê¸°ë¡)
CREATE TABLE auto_agent_runs (
  id TEXT PRIMARY KEY,
  cycle_id TEXT NOT NULL REFERENCES auto_cycles(id) ON DELETE CASCADE,
  agent_id TEXT NOT NULL REFERENCES auto_agents(id),
  agent_name TEXT NOT NULL,            -- ì¡°íšŒ í¸ì˜ìš© (ë¹„ì •ê·œí™”)
  iteration INTEGER NOT NULL DEFAULT 1, -- Reviewer â†” Developer ë°˜ë³µ ì‹œ íšŒì°¨
  status TEXT NOT NULL DEFAULT 'running',
    -- 'running' | 'completed' | 'failed' | 'skipped'
  prompt TEXT NOT NULL,                -- ì‹¤ì œ ì‹¤í–‰ëœ í”„ë¡¬í”„íŠ¸
  output TEXT NOT NULL DEFAULT '',     -- ì—ì´ì „íŠ¸ ì¶œë ¥
  cost_usd REAL,
  duration_ms INTEGER,
  started_at TEXT NOT NULL,
  completed_at TEXT
);
```

### 5.2 ì‹ ê·œ ì„¤ì • í‚¤ (auto_settings)

| key | default | ì„¤ëª… |
|-----|---------|------|
| `review_max_iterations` | `2` | Reviewer â†” Developer ìµœëŒ€ ë°˜ë³µ íšŸìˆ˜ |
| `skip_designer_for_fixes` | `true` | finding ìˆ˜ì • ì‹œ Product Designer ê±´ë„ˆë›°ê¸° |
| `require_initial_prompt` | `false` | ì´ˆê¸° í”„ë¡¬í”„íŠ¸ í•„ìˆ˜ ì—¬ë¶€ |

---

## 6. ì‚¬ì´í´ íë¦„ (v2)

### 6.1 ì „ì²´ íë¦„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Cycle #N                                      â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 1. ì¤€ë¹„                                                      â”‚ â”‚
â”‚  â”‚    - Safety ì²´í¬ (max_cycles, budget, consecutive_failures)  â”‚ â”‚
â”‚  â”‚    - User Prompt ë¹Œë“œ (initial + mid-session prompts)       â”‚ â”‚
â”‚  â”‚    - SESSION-STATE.md ë¡œë“œ                                  â”‚ â”‚
â”‚  â”‚    - Git Checkpoint                                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â–¼                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 2. Agent Pipeline ì‹¤í–‰                                       â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚    í™œì„±í™”ëœ ì—ì´ì „íŠ¸ë¥¼ pipeline_order ìˆœìœ¼ë¡œ ì‹¤í–‰:             â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚    for (const agent of enabledAgents) {                     â”‚ â”‚
â”‚  â”‚      context = buildAgentContext(agent, previousOutputs)    â”‚ â”‚
â”‚  â”‚      result = await executeAgent(agent, context)            â”‚ â”‚
â”‚  â”‚      previousOutputs.push(result)                           â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚      // Reviewer â†’ Developer ë£¨í”„                            â”‚ â”‚
â”‚  â”‚      if (agent.name === 'reviewer' && !result.approved) {   â”‚ â”‚
â”‚  â”‚        loop Developer â†’ Reviewer (ìµœëŒ€ NíšŒ)                  â”‚ â”‚
â”‚  â”‚      }                                                      â”‚ â”‚
â”‚  â”‚    }                                                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â–¼                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 3. ê²°ê³¼ ì²˜ë¦¬                                                  â”‚ â”‚
â”‚  â”‚    - QA ì‹¤íŒ¨ ì‹œ: rollback + finding ìƒì„±                     â”‚ â”‚
â”‚  â”‚    - ì„±ê³µ ì‹œ: finding resolved + git commit                  â”‚ â”‚
â”‚  â”‚    - SESSION-STATE.md ì—…ë°ì´íŠ¸                               â”‚ â”‚
â”‚  â”‚    - DB ê¸°ë¡ (auto_cycles, auto_agent_runs)                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â–¼                                    â”‚
â”‚                        ë‹¤ìŒ ì‚¬ì´í´ë¡œ                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 Finding ìˆ˜ì • ì‚¬ì´í´

ê¸°ì¡´ Findingì„ ìˆ˜ì •í•˜ëŠ” ì‚¬ì´í´ì—ì„œëŠ” íŒŒì´í”„ë¼ì¸ì´ ì•½ê°„ ë‹¬ë¼ì§„ë‹¤:

- `skip_designer_for_fixes = true` (ê¸°ë³¸ê°’): Designerë¥¼ ê±´ë„ˆë›°ê³  Developerë¶€í„° ì‹œì‘
- Developerì—ê²Œ Finding ì •ë³´ê°€ Feature Spec ëŒ€ì‹  ì „ë‹¬ë¨
- ë‚˜ë¨¸ì§€ íë¦„ì€ ë™ì¼ (Reviewer â†’ QA)

```
[Finding ìˆ˜ì • ì‚¬ì´í´]
Developer (finding ê¸°ë°˜) â†’ Reviewer â†’ QA
```

### 6.3 Phase ëŒ€ì²´

v1ì˜ Phase ì‹œìŠ¤í…œ(discovery/fix/test/improve/review)ì€ v2ì—ì„œ Agent Pipelineìœ¼ë¡œ ëŒ€ì²´ëœë‹¤.

| v1 Phase | v2 ëŒ€ì‘ |
|----------|---------|
| `discovery` | Product Designerê°€ ë‹´ë‹¹ (ê¸°ëŠ¥ ë°œê²¬/ì •ì˜) |
| `fix` | Developerê°€ Finding ê¸°ë°˜ìœ¼ë¡œ ìˆ˜ì • |
| `test` | QA Engineerê°€ ë‹´ë‹¹ |
| `improve` | Product Designerê°€ ê°œì„ ì  ë„ì¶œ â†’ Developer êµ¬í˜„ |
| `review` | Reviewerê°€ ë§¤ ì‚¬ì´í´ ë‹´ë‹¹ |

v1ì˜ `phase` ì»¬ëŸ¼ì€ ìœ ì§€í•˜ë˜, v2ì—ì„œëŠ” `'pipeline'`ìœ¼ë¡œ í†µì¼.
ì„¸ë¶€ ì§„í–‰ ìƒíƒœëŠ” `auto_agent_runs` í…Œì´ë¸”ë¡œ ì¶”ì .

---

## 7. Agent Context ë¹Œë“œ

ê° ì—ì´ì „íŠ¸ëŠ” ì‹¤í–‰ ì‹œ ë‹¤ìŒ ì»¨í…ìŠ¤íŠ¸ë¥¼ ë°›ëŠ”ë‹¤:

### 7.1 ê³µí†µ ì»¨í…ìŠ¤íŠ¸ (ëª¨ë“  ì—ì´ì „íŠ¸)

```
[User Prompt]
{buildUserPrompt() ê²°ê³¼}

[Session State]
{SESSION-STATE.md ë‚´ìš©}
```

### 7.2 ì—ì´ì „íŠ¸ë³„ ì¶”ê°€ ì»¨í…ìŠ¤íŠ¸

| Agent | ì¶”ê°€ ì»¨í…ìŠ¤íŠ¸ |
|-------|--------------|
| Product Designer | í˜„ì¬ open findings ëª©ë¡, ìµœê·¼ QA ê²°ê³¼ |
| Developer | ì´ì „ ì—ì´ì „íŠ¸(Designer)ì˜ ì¶œë ¥ (Feature Spec), Reviewer í”¼ë“œë°± (ë°˜ë³µ ì‹œ) |
| Reviewer | Developerì˜ ì½”ë“œ ë³€ê²½ì‚¬í•­ (git diff), Feature Spec |
| QA Engineer | Feature Spec, test_command, ì½”ë“œ ë³€ê²½ì‚¬í•­ ìš”ì•½ |

### 7.3 ì»¨í…ìŠ¤íŠ¸ ë¹Œë“œ í•¨ìˆ˜

```typescript
function buildAgentContext(
  agent: AutoAgent,
  session: AutoSession,
  userPrompt: string,
  stateContext: string,
  previousOutputs: Map<string, string>,
  finding?: AutoFinding | null
): string {
  const parts: string[] = [];

  // 1. ì—ì´ì „íŠ¸ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸
  parts.push(agent.system_prompt);

  // 2. User Prompt
  parts.push(`\n[User Prompt]\n${userPrompt}`);

  // 3. Session State
  parts.push(`\n[Session State]\n${stateContext}`);

  // 4. Finding ì •ë³´ (fix ì‚¬ì´í´)
  if (finding) {
    parts.push(`\n[ìˆ˜ì •í•  ë¬¸ì œ]\n- ì œëª©: ${finding.title}\n- ì„¤ëª…: ${finding.description}\n- íŒŒì¼: ${finding.file_path ?? 'N/A'}`);
  }

  // 5. ì´ì „ ì—ì´ì „íŠ¸ ì¶œë ¥
  for (const [agentName, output] of previousOutputs) {
    parts.push(`\n[${agentName} ì¶œë ¥]\n${output}`);
  }

  return parts.join('\n\n');
}
```

---

## 8. API ë³€ê²½

### 8.1 ê¸°ì¡´ API ìˆ˜ì •

```
POST /api/auto               # Bodyì— initialPrompt ì¶”ê°€
PATCH /api/auto               # resume ì‹œ Bodyì— midSessionPrompt ì¶”ê°€
```

### 8.2 ì‹ ê·œ API

```
# User Prompts
GET    /api/auto/prompts                ì„¸ì…˜ì˜ user prompt ëª©ë¡
POST   /api/auto/prompts                mid-session prompt ì¶”ê°€
DELETE /api/auto/prompts/:id            prompt ì‚­ì œ

# Agent ì •ì˜
GET    /api/auto/agents                 ì—ì´ì „íŠ¸ ëª©ë¡
GET    /api/auto/agents/:id             ì—ì´ì „íŠ¸ ìƒì„¸
POST   /api/auto/agents                 ì»¤ìŠ¤í…€ ì—ì´ì „íŠ¸ ìƒì„±
PUT    /api/auto/agents/:id             ì—ì´ì „íŠ¸ ìˆ˜ì •
DELETE /api/auto/agents/:id             ì»¤ìŠ¤í…€ ì—ì´ì „íŠ¸ ì‚­ì œ (builtinì€ ë¶ˆê°€)
PATCH  /api/auto/agents/:id/toggle      ì—ì´ì „íŠ¸ í™œì„±/ë¹„í™œì„± í† ê¸€
PUT    /api/auto/agents/reorder         íŒŒì´í”„ë¼ì¸ ìˆœì„œ ë³€ê²½

# Agent ì‹¤í–‰ ê¸°ë¡
GET    /api/auto/agent-runs?cycleId=... ì‚¬ì´í´ ë‚´ ì—ì´ì „íŠ¸ ì‹¤í–‰ ê¸°ë¡
GET    /api/auto/agent-runs/:id         ì‹¤í–‰ ê¸°ë¡ ìƒì„¸ (ì¶œë ¥ í¬í•¨)
```

---

## 9. UI ë³€ê²½

### 9.1 ì‹œì‘ ëª¨ë‹¬ (Initial Prompt)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Start Autonomous Mode                        â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚                                               â”‚
â”‚  Target Project                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ /Users/user/source/my-app                â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                               â”‚
â”‚  What do you want to build? (Optional)        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Reactë¡œ í• ì¼ ê´€ë¦¬ ì•±ì„ ë§Œë“¤ì–´ì¤˜.          â”‚â”‚
â”‚  â”‚ - Tailwind CSS ì‚¬ìš©                      â”‚â”‚
â”‚  â”‚ - ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ë¡œ ë°ì´í„° ì˜ì†í™”           â”‚â”‚
â”‚  â”‚ - ë‹¤í¬ëª¨ë“œ ì§€ì›                           â”‚â”‚
â”‚  â”‚                                          â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                               â”‚
â”‚              [Cancel]  [Start]                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.2 Resume ëª¨ë‹¬ (Mid-Session Prompt)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Resume Autonomous Mode                       â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚                                               â”‚
â”‚  Add instructions (Optional)                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ ë‹¤í¬ëª¨ë“œ ì§€ì›ì„ ì¶”ê°€í•´ì¤˜                   â”‚â”‚
â”‚  â”‚                                          â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                               â”‚
â”‚  Previous prompts:                            â”‚
â”‚  â€¢ [Initial] Reactë¡œ í• ì¼ ê´€ë¦¬ ì•±ì„ ë§Œë“¤ì–´ì¤˜  â”‚
â”‚  â€¢ [Cycle 3] ëª¨ë°”ì¼ ë°˜ì‘í˜•ìœ¼ë¡œ ë§Œë“¤ì–´ì¤˜       â”‚
â”‚                                               â”‚
â”‚            [Cancel]  [Resume]                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.3 Agent Pipeline ì‹¤ì‹œê°„ ë·°ì–´

ëŒ€ì‹œë³´ë“œì˜ í˜„ì¬ ì‚¬ì´í´ íŒ¨ë„ì´ ì—ì´ì „íŠ¸ë³„ íƒ­ìœ¼ë¡œ í™•ì¥ëœë‹¤:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Cycle #5 â€” Pipeline                                  â”‚
â”‚                                                       â”‚
â”‚  [Designer âœ…] [Developer â³] [Reviewer â¬œ] [QA â¬œ]  â”‚
â”‚                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Developer (running)                              â”‚ â”‚
â”‚  â”‚                                                   â”‚ â”‚
â”‚  â”‚ > Reading src/components/TodoList.tsx...          â”‚ â”‚
â”‚  â”‚ > Implementing drag and drop...                  â”‚ â”‚
â”‚  â”‚ > Writing test file...                           â”‚ â”‚
â”‚  â”‚ > â–ˆ                                              â”‚ â”‚
â”‚  â”‚                                                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                       â”‚
â”‚  Cost so far: $0.08 | Duration: 32s                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.4 Agent ê´€ë¦¬ í˜ì´ì§€ (`/auto/agents`)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Agent Pipeline                         [+ New Agent] â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚                                                       â”‚
â”‚  Pipeline Order:                                      â”‚
â”‚                                                       â”‚
â”‚  1. â— Product Designer              [Edit] [Toggle]  â”‚
â”‚     ì„œë¹„ìŠ¤ ìŠ¤í™/ê¸°ëŠ¥/UX ì •ì˜                           â”‚
â”‚                                                       â”‚
â”‚  2. â— Developer                     [Edit] [Toggle]  â”‚
â”‚     ì½”ë“œ êµ¬í˜„                                         â”‚
â”‚                                                       â”‚
â”‚  3. â— Reviewer                      [Edit] [Toggle]  â”‚
â”‚     ì½”ë“œ ë¦¬ë·° ë° í”¼ë“œë°±                               â”‚
â”‚                                                       â”‚
â”‚  3.5 â—‹ Security Auditor       [Edit] [Toggle] [Del]  â”‚
â”‚     ë³´ì•ˆ ì·¨ì•½ì  ë¶„ì„ (ë¹„í™œì„±)                          â”‚
â”‚                                                       â”‚
â”‚  4. â— QA Engineer                   [Edit] [Toggle]  â”‚
â”‚     í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ë° í’ˆì§ˆ ê²€ì¦                           â”‚
â”‚                                                       â”‚
â”‚  â— = í™œì„±  â—‹ = ë¹„í™œì„±                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.5 Agent í¸ì§‘ ëª¨ë‹¬

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Edit Agent: Developer                        â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚                                               â”‚
â”‚  Display Name                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Developer                                â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                               â”‚
â”‚  Role Description                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ ì½”ë“œ êµ¬í˜„                                â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                               â”‚
â”‚  System Prompt (Markdown)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ ë‹¹ì‹ ì€ ì‹œë‹ˆì–´ ê°œë°œìì…ë‹ˆë‹¤.               â”‚â”‚
â”‚  â”‚                                          â”‚â”‚
â”‚  â”‚ Feature Specì„ ë°›ì•„ ì½”ë“œë¥¼ êµ¬í˜„í•˜ì„¸ìš”.    â”‚â”‚
â”‚  â”‚ ...                                      â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                               â”‚
â”‚  Pipeline Order: [2   ]                       â”‚
â”‚                                               â”‚
â”‚              [Cancel]  [Save]                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.6 ì‚¬ì´ë“œë°” ë©”ë‰´ ë³€ê²½

Auto ëª¨ë“œ ì‚¬ì´ë“œë°”ì— "Agents" ë©”ë‰´ í•­ëª© ì¶”ê°€:

```
Auto Mode:
  ğŸ“Š Dashboard     (/auto)
  ğŸ” Findings      (/auto/findings)
  ğŸ¤– Agents        (/auto/agents)     â† ì‹ ê·œ
  ğŸ”„ Cycles        (/auto/cycles)
  ğŸ“œ History        (/auto/history)
  âš™ï¸ Settings       (/auto/settings)
```

---

## 10. SSE ì´ë²¤íŠ¸ ì¶”ê°€

```typescript
// ê¸°ì¡´ ì´ë²¤íŠ¸ì— ì¶”ê°€
type AutoSSEEventType =
  | ... // ê¸°ì¡´ ì´ë²¤íŠ¸ ìœ ì§€
  | 'agent_start'          // ì—ì´ì „íŠ¸ ì‹¤í–‰ ì‹œì‘
  | 'agent_complete'       // ì—ì´ì „íŠ¸ ì‹¤í–‰ ì™„ë£Œ
  | 'agent_failed'         // ì—ì´ì „íŠ¸ ì‹¤í–‰ ì‹¤íŒ¨
  | 'review_iteration'     // Reviewer â†’ Developer ë°˜ë³µ ì‹œì‘
  | 'user_prompt_added';   // ì‚¬ìš©ì í”„ë¡¬í”„íŠ¸ ì¶”ê°€ë¨
```

---

## 11. êµ¬í˜„ ìˆœì„œ

### Phase 1: ë°ì´í„° ê¸°ë°˜
1. DB ë§ˆì´ê·¸ë ˆì´ì…˜ (auto_sessions ìˆ˜ì •, ì‹ ê·œ í…Œì´ë¸” 3ê°œ)
2. `auto_user_prompts` CRUD
3. `auto_agents` CRUD + ê¸°ë³¸ 4ê°œ ì—ì´ì „íŠ¸ seed
4. `auto_agent_runs` CRUD
5. User Prompt ë¹Œë” í•¨ìˆ˜

### Phase 2: Agent Pipeline ì—”ì§„
6. Agent Context ë¹Œë”
7. Agent Executor (ë‹¨ì¼ ì—ì´ì „íŠ¸ ì‹¤í–‰)
8. Pipeline Executor (ìˆœì°¨ íŒŒì´í”„ë¼ì¸ ì‹¤í–‰)
9. Reviewer â†” Developer ë£¨í”„ ë¡œì§
10. CycleEngine v2 (ê¸°ì¡´ Phase ê¸°ë°˜ â†’ Pipeline ê¸°ë°˜ìœ¼ë¡œ êµì²´)

### Phase 3: API
11. `/api/auto/prompts` ì—”ë“œí¬ì¸íŠ¸
12. `/api/auto/agents` ì—”ë“œí¬ì¸íŠ¸
13. `/api/auto/agent-runs` ì—”ë“œí¬ì¸íŠ¸
14. ê¸°ì¡´ `/api/auto` start/resumeì— prompt íŒŒë¼ë¯¸í„° ì¶”ê°€

### Phase 4: Frontend
15. ì‹œì‘ ëª¨ë‹¬ (Initial Prompt ì…ë ¥)
16. Resume ëª¨ë‹¬ (Mid-Session Prompt)
17. Agent Pipeline ì‹¤ì‹œê°„ ë·°ì–´
18. Agent ê´€ë¦¬ í˜ì´ì§€ (`/auto/agents`)
19. Cycle ìƒì„¸ì— Agent Run í‘œì‹œ
20. ì‚¬ì´ë“œë°”ì— Agents ë©”ë‰´ ì¶”ê°€

### Phase 5: í…ŒìŠ¤íŠ¸ + ì•ˆì „ì¥ì¹˜
21. Review â†” Developer ë£¨í”„ ë¬´í•œ ë°˜ë³µ ë°©ì§€
22. ê¸°ì¡´ v1 í…ŒìŠ¤íŠ¸ í˜¸í™˜ì„± í™•ì¸
23. E2E í…ŒìŠ¤íŠ¸

---

## 12. ì„¤ì • ê¸°ë³¸ê°’ (v2 ì¶”ê°€ë¶„)

```
review_max_iterations    : 2
skip_designer_for_fixes  : true
require_initial_prompt   : false
```

---

## 13. ë§ˆì´ê·¸ë ˆì´ì…˜ ì „ëµ

v1ì—ì„œ v2ë¡œì˜ ì „í™˜ì€ **í•˜ìœ„ í˜¸í™˜**ì„ ìœ ì§€í•œë‹¤:

- v1ì˜ Phase ê¸°ë°˜ ì‚¬ì´í´ì€ ê·¸ëŒ€ë¡œ DBì— ë‚¨ìŒ
- v2 ì‚¬ì´í´ì€ `phase = 'pipeline'`ìœ¼ë¡œ êµ¬ë¶„
- ê¸°ì¡´ settings, findings, sessions í…Œì´ë¸”ì€ ìˆ˜ì • ìµœì†Œí™”
- Agent Pipelineì´ ë¹„í™œì„±í™”ë˜ë©´ v1 ë°©ì‹ìœ¼ë¡œ fallback ê°€ëŠ¥ (ì„¤ì •ìœ¼ë¡œ í† ê¸€)
